CREATE STREAM stressStream (
    timestamp VARCHAR,
    stressId INT,
    status VARCHAR,
    stressLevel INT
  ) WITH (
     KAFKA_TOPIC='stress',
     VALUE_FORMAT='JSON',
     timestamp = 'timestamp',
    timestamp_format = 'yyyy-MM-dd HH:mm:ss'
  );

  CREATE STREAM weightStream (
    timestamp VARCHAR,
    weightId INT,
    weight DOUBLE
  ) WITH (
     KAFKA_TOPIC='weight',
     VALUE_FORMAT='JSON',
     timestamp = 'timestamp',
    timestamp_format = 'yyyy-MM-dd HH:mm:ss'
  );

  CREATE STREAM outputStream (
    windowOpen VARCHAR,
    windowClose VARCHAR,
    id INT,
    maxStress INT
  ) WITH (
     KAFKA_TOPIC='output2',
     VALUE_FORMAT='JSON',
     timestamp = 'windowClose',
    timestamp_format = 'yyyy-MM-dd HH:mm:ss'
  );

  1.
  SELECT
  from_unixtime(WINDOWSTART) AS window_start,
  from_unixtime(WINDOWEND) AS window_end,
  MAX(stressLevel) AS max_stress
FROM stressStream
  WINDOW TUMBLING (SIZE 10 SECONDS)
  EMIT CHANGES;

  2.
  SELECT
  from_unixtime(WINDOWSTART) AS window_start,
  from_unixtime(WINDOWEND) AS window_end,
  MAX(stressLevel) AS max_stress
FROM stressStream
  WINDOW HOPPING (SIZE 10 SECONDS, ADVANCE BY 5 SECONDS)
  EMIT CHANGES;

  3.
  SELECT
  from_unixtime(WINDOWSTART) AS window_start,
  from_unixtime(WINDOWEND) AS window_end,
  stressId,
  MAX(stressLevel) AS max_stress
FROM stressStream
  WINDOW TUMBLING (SIZE 10 SECONDS)
  GROUP BY stressId
  EMIT CHANGES;

  4.
  SELECT
  from_unixtime(WINDOWSTART) AS window_start,
  from_unixtime(WINDOWEND) AS window_end,
  stressId,
  MAX(stressLevel) AS max_stress
FROM stressStream
  WINDOW HOPPING (SIZE 10 SECONDS, ADVANCE BY 5 SECONDS)
  GROUP BY stressId
  EMIT CHANGES;

  5.
SELECT
  from_unixtime(WINDOWSTART) as window_start,
  from_unixtime(WINDOWEND) as window_end,
  stressId,
  MAX(stressLevel) AS max_stress
FROM stressStream
  WINDOW SESSION (3 SECONDS)
  GROUP BY stressId
  EMIT CHANGES;

  6.
    SELECT
    from_unixtime(WINDOWSTART) as window_start,
    from_unixtime(WINDOWEND) as window_end,
    MIN(stressLevel) AS min_stress
  FROM stressStream
    WINDOW TUMBLING (SIZE 10 SECONDS)
    EMIT CHANGES;

    7.
    SELECT
    from_unixtime(WINDOWSTART) as window_start,
    from_unixtime(WINDOWEND) as window_end,
    MIN(stressLevel) AS min_stress
  FROM stressStream
    WINDOW HOPPING (SIZE 10 SECONDS, ADVANCE BY 5 SECONDS)
    EMIT CHANGES;

    8.
    SELECT
    from_unixtime(WINDOWSTART) as window_start,
    from_unixtime(WINDOWEND) as window_end,
    stressId,
    MIN(stressLevel) AS min_stress
  FROM stressStream
    WINDOW TUMBLING (SIZE 10 SECONDS)
    GROUP BY stressId
    EMIT CHANGES;

    9.
    SELECT
    from_unixtime(WINDOWSTART) as window_start,
    from_unixtime(WINDOWEND) as window_end,
    stressId,
    min(stressLevel) as min_stress
  FROM stressStream
    WINDOW HOPPING (SIZE 10 SECONDS, ADVANCE BY 5 SECONDS)
    GROUP BY stressId
    EMIT CHANGES;

    10.
  SELECT
    from_unixtime(WINDOWSTART) as window_start,
    from_unixtime(WINDOWEND) as window_end,
    stressId,
    min(stressLevel) as min_stress
  FROM stressStream
    WINDOW SESSION (3 SECONDS)
    GROUP BY stressId
    EMIT CHANGES;

  11.
    SELECT
    from_unixtime(WINDOWSTART) as window_start,
    from_unixtime(WINDOWEND) as window_end,
    avg(weight) as avg_weight
  FROM weightStream
    WINDOW TUMBLING (SIZE 10 SECONDS)
    EMIT CHANGES;

    12.
    SELECT
        from_unixtime(WINDOWSTART) as window_start,
        from_unixtime(WINDOWEND) as window_end,
        avg(weight) as avg_weight
    FROM weightStream
        WINDOW HOPPING (SIZE 10 SECONDS, ADVANCE BY 5 SECONDS)
    EMIT CHANGES;

    13.
    SELECT
        from_unixtime(WINDOWSTART) as window_start,
        from_unixtime(WINDOWEND) as window_end,
        weightId,
        avg(weight) as avg_weight
    FROM weightStream
        WINDOW TUMBLING (SIZE 10 SECONDS)
    GROUP BY weightId
    EMIT CHANGES;

    14.
    SELECT
    from_unixtime(WINDOWSTART) as window_start,
    from_unixtime(WINDOWEND) as window_end,
    weightId,
    avg(weight) as avg_weight
    FROM weightStream
        WINDOW HOPPING (SIZE 10 SECONDS, ADVANCE BY 5 SECONDS)
    GROUP BY weightId
    EMIT CHANGES;

    15.
  SELECT
    from_unixtime(WINDOWSTART) as window_start,
    from_unixtime(WINDOWEND) as window_end,
    weightId,
    avg(weight) as avg_weight
      FROM weightStream
    WINDOW SESSION (3 SECONDS)
    GROUP BY weightId
    EMIT CHANGES;

  16.
  SELECT
  from_unixtime(WINDOWSTART) as window_start,
  from_unixtime(WINDOWEND) as window_end,
  count(*) as numberOfEvents
FROM weightStream
  WINDOW TUMBLING (SIZE 10 SECONDS)
  EMIT CHANGES;

  17.
  SELECT
      from_unixtime(WINDOWSTART) as window_start,
      from_unixtime(WINDOWEND) as window_end,
      count(*) as numberOfEvents
  FROM weightStream
      WINDOW HOPPING (SIZE 10 SECONDS, ADVANCE BY 5 SECONDS)
  EMIT CHANGES;

  18.
  SELECT
      from_unixtime(WINDOWSTART) as window_start,
      from_unixtime(WINDOWEND) as window_end,
      weightId,
      count(*) as numberOfEvents
  FROM weightStream
      WINDOW TUMBLING (SIZE 10 SECONDS)
  GROUP BY weightId
  EMIT CHANGES;

  19.
  SELECT
  from_unixtime(WINDOWSTART) as window_start,
  from_unixtime(WINDOWEND) as window_end,
  weightId,
  count(*) as numberOfEvents
    FROM weightStream
  WINDOW HOPPING (SIZE 10 SECONDS, ADVANCE BY 5 SECONDS)
  GROUP BY weightId
  EMIT CHANGES;

  20.
SELECT
  from_unixtime(WINDOWSTART) as window_start,
  from_unixtime(WINDOWEND) as window_end,
  weightId,
  count(*) as numberOfEvents
    FROM weightStream
  WINDOW SESSION (3 SECONDS)
  GROUP BY weightId
  EMIT CHANGES;

7.
SELECT
    s.timestamp,
    s.stressId,
    s.status,
    s.stressLevel,
    w.timestamp,
    w.weight
FROM stressStream s INNER JOIN weightStream w
WITHIN 5 SECONDS ON s.stressId=w.weightId EMIT CHANGES;


Third level query

SELECT
  from_unixtime(WINDOWSTART) as windowOpen,
  from_unixtime(WINDOWEND) as windowClose,
  id,
  max(maxStress) as maxStress
FROM outputStream
  WINDOW TUMBLING (SIZE 10 SECONDS)
  GROUP BY id
  EMIT CHANGES;